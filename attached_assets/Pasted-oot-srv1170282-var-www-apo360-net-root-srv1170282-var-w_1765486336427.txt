oot@srv1170282:/var/www/apo360.net#
root@srv1170282:/var/www/apo360.net# psql "postgresql://apo360_admin:Admin2025@127.0.0.1:5432/apo360_prod?sslmode=disable" -c "ALTER TABLE usuario_roles ADD COLUMN IF NOT EXISTS categoria_rol_id VARCHAR(255); ALTER TABLE usuario_roles ADD COLUMN IF NOT EXISTS subcategoria_rol_id VARCHAR(255);"
ALTER TABLE
ALTER TABLE
root@srv1170282:/var/www/apo360.net# psql "postgresql://apo360_admin:Admin2025@127.0.0.1:5432/apo360_prod?sslmode=disable" -c "\d usuario_roles"
                                 Table "public.usuario_roles"
       Column        |            Type             | Collation | Nullable |      Default
---------------------+-----------------------------+-----------+----------+-------------------
 id                  | character varying           |           | not null | gen_random_uuid()
 usuario_id          | character varying           |           |          |
 rol                 | character varying(50)       |           | not null |
 created_at          | timestamp without time zone |           |          | now()
 categoria_rol_id    | character varying(255)      |           |          |
 subcategoria_rol_id | character varying(255)      |           |          |
Indexes:
    "usuario_roles_pkey" PRIMARY KEY, btree (id)
Foreign-key constraints:
    "usuario_roles_usuario_id_users_id_fk" FOREIGN KEY (usuario_id) REFERENCES users(id)

root@srv1170282:/var/www/apo360.net# npm run build

> rest-express@1.0.0 build
> vite build && esbuild server/index-prod.ts --platform=node --packages=external --bundle --format=esm --outfile=dist/index.js

vite v5.4.20 building for production...
transforming (4) src/App.tsx
A PostCSS plugin did not pass the `from` option to `postcss.parse`. This may cause imported assets to be incorrectly transformed. If you've recently added a PostCSS plugin that raised this warning, please contact the package author to fix the issue.
âœ“ 2792 modules transformed.
../dist/public/index.html                     1.53 kB â”‚ gzip:   0.66 kB
../dist/public/assets/index-BnNusofl.css    147.72 kB â”‚ gzip:  27.36 kB
../dist/public/assets/index-8rziSsO1.js   1,497.09 kB â”‚ gzip: 374.43 kB

(!) Some chunks are larger than 500 kB after minification. Consider:
- Using dynamic import() to code-split the application
- Use build.rollupOptions.output.manualChunks to improve chunking: https://rollupjs.org/configuration-options/#output-manualchunks
- Adjust chunk size limit for this warning via build.chunkSizeWarningLimit.
âœ“ built in 16.85s
â–² [WARNING] Duplicate member "updateServicio" in class body [duplicate-class-member]

    server/storage.ts:1885:8:
      1885 â”‚   async updateServicio(id: string, data: any): Promise<any> {
           â•µ         ~~~~~~~~~~~~~~

  The original member "updateServicio" is here:

    server/storage.ts:827:8:
      827 â”‚   async updateServicio(id: string, data: Partial<InsertServicio>): Promise<Servicio | undefined> {
          â•µ         ~~~~~~~~~~~~~~

â–² [WARNING] Duplicate member "getFavoritosUsuario" in class body [duplicate-class-member]

    server/storage.ts:2450:8:
      2450 â”‚   async getFavoritosUsuario(usuarioId: string, tipo?: string): Promise<any[]> {
           â•µ         ~~~~~~~~~~~~~~~~~~~

  The original member "getFavoritosUsuario" is here:

    server/storage.ts:795:8:
      795 â”‚   async getFavoritosUsuario(usuarioId: string): Promise<any[]> {
          â•µ         ~~~~~~~~~~~~~~~~~~~

â–² [WARNING] Duplicate member "getInteraccionesUsuario" in class body [duplicate-class-member]

    server/storage.ts:2633:8:
      2633 â”‚   async getInteraccionesUsuario(
           â•µ         ~~~~~~~~~~~~~~~~~~~~~~~

  The original member "getInteraccionesUsuario" is here:

    server/storage.ts:571:8:
      571 â”‚   async getInteraccionesUsuario(publicidadId: string, usuarioId: string): Promise<{ hasLike: boolean; has...
          â•µ         ~~~~~~~~~~~~~~~~~~~~~~~

â–² [WARNING] Duplicate member "getComentarios" in class body [duplicate-class-member]

    server/storage.ts:2657:8:
      2657 â”‚   async getComentarios(tipoContenido: string, contenidoId: string): Promise<Comentario[]> {
           â•µ         ~~~~~~~~~~~~~~

  The original member "getComentarios" is here:

    server/storage.ts:1854:8:
      1854 â”‚   async getComentarios(tipoContenido: string, contenidoId: string): Promise<Comentario[]> {
           â•µ         ~~~~~~~~~~~~~~

â–² [WARNING] Duplicate member "createComentario" in class body [duplicate-class-member]

    server/storage.ts:2673:8:
      2673 â”‚   async createComentario(data: InsertComentario): Promise<Comentario> {
           â•µ         ~~~~~~~~~~~~~~~~

  The original member "createComentario" is here:

    server/storage.ts:1867:8:
      1867 â”‚   async createComentario(data: InsertComentario): Promise<Comentario> {
           â•µ         ~~~~~~~~~~~~~~~~

â–² [WARNING] Duplicate member "deleteComentario" in class body [duplicate-class-member]

    server/storage.ts:2687:8:
      2687 â”‚   async deleteComentario(id: string): Promise<void> {
           â•µ         ~~~~~~~~~~~~~~~~

  The original member "deleteComentario" is here:

    server/storage.ts:1875:8:
      1875 â”‚   async deleteComentario(id: string): Promise<void> {
           â•µ         ~~~~~~~~~~~~~~~~

6 of 7 warnings shown (disable the message limit with --log-limit=0)

  dist/index.js  405.7kb

âš¡ Done in 66ms
root@srv1170282:/var/www/apo360.net# pm2 restart apo360
Use --update-env to update environment variables
[PM2] Applying action restartProcessId on app [apo360](ids: [ 0 ])
[PM2] [apo360](0) âœ“
â”Œâ”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ id â”‚ name               â”‚ mode     â”‚ â†º    â”‚ status    â”‚ cpu      â”‚ memory   â”‚
â”œâ”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 0  â”‚ apo360             â”‚ cluster  â”‚ 13   â”‚ online    â”‚ 0%       â”‚ 40.4mb   â”‚
â””â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
root@srv1170282:/var/www/apo360.net# pm2 logs apo360 --lines 20
[TAILING] Tailing last 20 lines for [apo360] process (change the value with --lines option)
/var/www/apo360.net/logs/error-0.log last 20 lines:
0|apo360   |     at async DatabaseStorage.getUserRoles (file:///var/www/apo360.net/dist/index.js:2040:33)
0|apo360   |     at async file:///var/www/apo360.net/dist/index.js:9323:25 {
0|apo360   |   length: 116,
0|apo360   |   severity: 'ERROR',
0|apo360   |   code: '42703',
0|apo360   |   detail: undefined,
0|apo360   |   hint: undefined,
0|apo360   |   position: '35',
0|apo360   |   internalPosition: undefined,
0|apo360   |   internalQuery: undefined,
0|apo360   |   where: undefined,
0|apo360   |   schema: undefined,
0|apo360   |   table: undefined,
0|apo360   |   column: undefined,
0|apo360   |   dataType: undefined,
0|apo360   |   constraint: undefined,
0|apo360   |   file: 'parse_relation.c',
0|apo360   |   line: '3722',
0|apo360   |   routine: 'errorMissingColumn'
0|apo360   | }

/var/www/apo360.net/logs/output-0.log last 20 lines:
0|apo360   | 2025-12-12T04:05:52: âŒ WebSocket rechazado: Usuario no autenticado
0|apo360   | 2025-12-12T04:05:57: âŒ WebSocket rechazado: Usuario no autenticado
0|apo360   | 2025-12-12T04:06:01: âŒ WebSocket rechazado: Usuario no autenticado
0|apo360   | 2025-12-12T04:06:03: âŒ WebSocket rechazado: Usuario no autenticado
0|apo360   | 2025-12-12T04:06:08: âŒ WebSocket rechazado: Usuario no autenticado
0|apo360   | 2025-12-12T04:06:12: âŒ WebSocket rechazado: Usuario no autenticado
0|apo360   | 2025-12-12T04:06:13: ğŸ—„ï¸ Usando PostgreSQL local (producciÃ³n)
0|apo360   | 2025-12-12T04:06:13: ğŸ” Modo de autenticaciÃ³n solicitado: basic
0|apo360   | 2025-12-12T04:06:13: ğŸ” Configurando autenticaciÃ³n bÃ¡sica (email/contraseÃ±a)...
0|apo360   | 2025-12-12T04:06:13: âœ… AutenticaciÃ³n bÃ¡sica configurada
0|apo360   | 2025-12-12T04:06:13:    ğŸ“§ Login: POST /api/auth/login
0|apo360   | 2025-12-12T04:06:13:    ğŸ“ Registro: POST /api/auth/register
0|apo360   | 2025-12-12T04:06:13: ğŸš€ Servidor WebSocket configurado en /ws
0|apo360   | 2025-12-12T04:06:13: 4:06:13 AM [express] ğŸ”„ Verificando migraciÃ³n de miembros_grupo...
0|apo360   | 2025-12-12T04:06:13: 4:06:13 AM [express] âœ… Tabla miembros_grupo ya estÃ¡ sincronizada
0|apo360   | 2025-12-12T04:06:13: 4:06:13 AM [express] serving on port 5000
0|apo360   | 2025-12-12T04:06:14: âŒ WebSocket rechazado: Usuario no autenticado
0|apo360   | 2025-12-12T04:06:19: âŒ WebSocket rechazado: Usuario no autenticad