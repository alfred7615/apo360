oot@srv1170282:/var/www/apo360.net# cd /var/www/apo360.net
root@srv1170282:/var/www/apo360.net# npm run db:push

> rest-express@1.0.0 db:push
> drizzle-kit push

No config path provided, using default 'drizzle.config.ts'
Reading config file '/var/www/apo360.net/drizzle.config.ts'
Using 'pg' driver for database querying
[âœ“] Pulling schema from database...

+ telefono column will be created

+ imei_dispositivo column will be created

+ first_name column will be created

+ last_name column will be created

+ profile_image_url column will be created

+ rol column will be created

+ estado column will be created

+ latitud column will be created

+ longitud column will be created

+ en_linea column will be created

+ ultima_conexion column will be created

+ modo_taxi column will be created

+ vehiculo_modelo column will be created

+ vehiculo_placa column will be created

+ disponible_taxi column will be created

+ nombre_local column will be created

+ categoria_local column will be created

+ direccion_local column will be created

+ logo_local column will be created

+ descripcion_local column will be created

+ created_at column will be created

+ updated_at column will be created

+ nivel_usuario column will be created

+ alias column will be created

+ dni column will be created

+ dni_imagen_frente column will be created

+ dni_imagen_posterior column will be created

+ dni_emision column will be created

+ dni_caducidad column will be created

+ pais column will be created

+ departamento column will be created

+ distrito column will be created

+ sector column will be created

+ direccion column will be created

+ manzana_lote column will be created

+ avenida_calle column will be created

+ gps_latitud column will be created

+ gps_longitud column will be created

+ ruc column will be created

+ gps_local_latitud column will be created

+ gps_local_longitud column will be created

+ brevete_imagen_frente column will be created

+ brevete_imagen_posterior column will be created

+ brevete_emision column will be created

+ brevete_caducidad column will be created

+ soat_imagen_frente column will be created

+ soat_imagen_posterior column will be created

+ soat_emision column will be created

+ soat_caducidad column will be created

+ revision_tecnica_imagen_frente column will be created

+ revision_tecnica_imagen_posterior column will be created

+ revision_tecnica_emision column will be created

+ revision_tecnica_caducidad column will be created

+ credencial_conductor_imagen_frente column will be created

+ credencial_conductor_imagen_posterior column will be created

+ credencial_conductor_emision column will be created

+ credencial_conductor_caducidad column will be created

+ credencial_taxi_imagen_frente column will be created

+ credencial_taxi_imagen_posterior column will be created

+ credencial_taxi_emision column will be created

+ credencial_taxi_caducidad column will be created

+ tipo_vehiculo column will be created

+ vehiculo_foto_frente column will be created

+ vehiculo_foto_posterior column will be created

+ vehiculo_foto_lateral_izq column will be created

+ vehiculo_foto_lateral_der column will be created

+ foto_domicilio column will be created

+ password_hash column will be created

+ motivo_suspension column will be created

+ fecha_suspension column will be created

+ motivo_bloqueo column will be created

+ fecha_bloqueo column will be created

+ local_foto_1 column will be created

+ local_foto_2 column will be created

+ local_foto_3 column will be created

+ local_foto_4 column will be created

+ local_video_1 column will be created

+ local_video_2 column will be created
--- all columns conflicts in users table resolved ---

error: permission denied for table users
    at /var/www/apo360.net/node_modules/pg-pool/index.js:45:11
    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)
    at async Object.query (/var/www/apo360.net/node_modules/drizzle-kit/bin.cjs:80601:26)
    at async pgSuggestions (/var/www/apo360.net/node_modules/drizzle-kit/bin.cjs:81997:23)
    at async pgPush (/var/www/apo360.net/node_modules/drizzle-kit/bin.cjs:84368:15)
    at async Object.handler (/var/www/apo360.net/node_modules/drizzle-kit/bin.cjs:93813:9)
    at async run (/var/www/apo360.net/node_modules/drizzle-kit/bin.cjs:93059:7) {
  length: 93,
  severity: 'ERROR',
  code: '42501',
  detail: undefined,
  hint: undefined,
  position: undefined,
  internalPosition: undefined,
  internalQuery: undefined,
  where: undefined,
  schema: undefined,
  table: undefined,
  column: undefined,
  dataType: undefined,
  constraint: undefined,
  file: 'aclchk.c',
  line: '2812',
  routine: 'aclcheck_error'
}
root@srv1170282:/var/www/apo360.net#
root@srv1170282:/var/www/apo360.net#
root@srv1170282:/var/www/apo360.net#
root@srv1170282:/var/www/apo360.net#
root@srv1170282:/var/www/apo360.net# pm2 restart apo360 --update-env
[PM2] Applying action restartProcessId on app [apo360](ids: [ 0 ])
[PM2] [apo360](0) âœ“
â”Œâ”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ id â”‚ name               â”‚ mode     â”‚ â†º    â”‚ status    â”‚ cpu      â”‚ memory   â”‚
â”œâ”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 0  â”‚ apo360             â”‚ cluster  â”‚ 7    â”‚ online    â”‚ 0%       â”‚ 41.5mb   â”‚
â””â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
root@srv1170282:/var/www/apo360.net# pm2 logs apo360 --lines 20
[TAILING] Tailing last 20 lines for [apo360] process (change the value with --lines option)
/var/www/apo360.net/logs/error-0.log last 20 lines:
0|apo360   |     at process.processTicksAndRejections (node:internal/process/task_queues:95:5)
0|apo360   |     at async PGStore._asyncQuery (/var/www/apo360.net/node_modules/connect-pg-simple/index.js:322:21) {
0|apo360   |   length: 107,
0|apo360   |   severity: 'ERROR',
0|apo360   |   code: '42P01',
0|apo360   |   detail: undefined,
0|apo360   |   hint: undefined,
0|apo360   |   position: '13',
0|apo360   |   internalPosition: undefined,
0|apo360   |   internalQuery: undefined,
0|apo360   |   where: undefined,
0|apo360   |   schema: undefined,
0|apo360   |   table: undefined,
0|apo360   |   column: undefined,
0|apo360   |   dataType: undefined,
0|apo360   |   constraint: undefined,
0|apo360   |   file: 'parse_relation.c',
0|apo360   |   line: '1449',
0|apo360   |   routine: 'parserOpenTable'
0|apo360   | }

/var/www/apo360.net/logs/output-0.log last 20 lines:
0|apo360   | 2025-12-10T02:00:33: 2:00:33 AM [express] GET /api/archivos-mp3 500 in 4ms :: {"message":"Internal Server Error"}
0|apo360   | 2025-12-10T02:00:33: 2:00:33 AM [express] GET /api/servicios 500 in 5ms :: {"message":"Internal Server Error"}
0|apo360   | 2025-12-10T02:00:33: 2:00:33 AM [express] GET /api/estadisticas/publicas 500 in 6ms :: {"message":"Internal Server Error"}
0|apo360   | 2025-12-10T02:00:33: 2:00:33 AM [express] GET /api/publicidad 500 in 6ms :: {"message":"Internal Server Error"}
0|apo360   | 2025-12-10T02:00:33: 2:00:33 AM [express] GET /api/configuracion/franja_emergencia 500 in 5ms :: {"message":"Internal Serâ€¦
0|apo360   | 2025-12-10T02:00:34: 2:00:34 AM [express] GET /api/configuracion/roles 500 in 3ms :: {"message":"Internal Server Error"}
0|apo360   | 2025-12-10T02:00:34: 2:00:34 AM [express] GET /api/configuracion/franja_emergencia 500 in 3ms :: {"message":"Internal Serâ€¦
0|apo360   | 2025-12-10T02:00:36: 2:00:36 AM [express] POST /api/auth/login 500 in 2ms :: {"message":"Internal Server Error"}
0|apo360   | 2025-12-10T02:18:58: ğŸ” Modo de autenticaciÃ³n solicitado: google
0|apo360   | 2025-12-10T02:18:58: âœ… Google OAuth configurado correctamente
0|apo360   | 2025-12-10T02:18:58: ğŸš€ Servidor WebSocket configurado en /ws
0|apo360   | 2025-12-10T02:18:58: 2:18:58 AM [express] ğŸ”„ Verificando migraciÃ³n de miembros_grupo...
0|apo360   | 2025-12-10T02:18:58: 2:18:58 AM [express] âš ï¸ Error en migraciÃ³n automÃ¡tica (se ignorarÃ¡): [object Object]
0|apo360   | 2025-12-10T02:18:58: 2:18:58 AM [express] serving on port 5000
0|apo360   | 2025-12-10T02:22:40: ğŸ” Modo de autenticaciÃ³n solicitado: google
0|apo360   | 2025-12-10T02:22:40: âœ… Google OAuth configurado correctamente
0|apo360   | 2025-12-10T02:22:40: ğŸš€ Servidor WebSocket configurado en /ws
0|apo360   | 2025-12-10T02:22:40: 2:22:40 AM [express] ğŸ”„ Verificando migraciÃ³n de miembros_grupo...
0|apo360   | 2025-12-10T02:22:40: 2:22:40 AM [express] âš ï¸ Error en migraciÃ³n automÃ¡tica (se ignorarÃ¡): [object Object]
0|apo360   | 2025-12-10T02:22:40: 2:22:40 AM [express] serving on port 5000
