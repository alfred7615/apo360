oot@srv1170282:/var/www/apo360.net# git stash
Saved working directory and index state WIP on main: 0837108 Rename configuration file to support module system
root@srv1170282:/var/www/apo360.net# git pull origin main
From https://github.com/alfred7615/apo360
 * branch            main       -> FETCH_HEAD
Updating 0837108..5c87ad5
Fast-forward
 ...List-of-relations-List-of-relations-Schema--1765334883_1765334883493.txt |  33 +++++
 ...ot-srv1170282-var-www-apo360-net-cd-var-www-apo360-net_1765333353849.txt | 251 ++++++++++++++++++++++++++++++++++++
 ...edencial-taxi-emision-column-will-be-created-credencia_1765333968142.txt | 115 +++++++++++++++++
 ...oot-srv1170282-var-www-apo360-net-cd-var-www-apo360-ne_1765322935733.txt |  39 ++++++
 ...oot-srv1170282-var-www-apo360-net-pm2-restart-apo360-u_1765333125358.txt |  53 ++++++++
 ...oot-srv1170282-var-www-apo360-net-pm2-start-ecosystem-_1765327761966.txt |  79 ++++++++++++
 ...oot-srv1170282-var-www-apo360-net-root-srv1170282-var-_1765323644578.txt |  63 +++++++++
 ...oot-srv1170282-var-www-apo360-net-root-srv1170282-var-_1765327946394.txt |  55 ++++++++
 ...oot-srv1170282-var-www-apo360-net-root-srv1170282-var-_1765329509881.txt |  76 +++++++++++
 ...oot-srv1170282-var-www-apo360-net-root-srv1170282-var-_1765329796410.txt |  58 +++++++++
 ...oot-srv1170282-var-www-apo360-net-root-srv1170282-var-_1765333564543.txt | 232 +++++++++++++++++++++++++++++++++
 ...oot-srv1170282-var-www-apo360-net-root-srv1170282-var-_1765334745407.txt |  58 +++++++++
 package-lock.json                                                           |  45 +++----
 package.json                                                                |   1 +
 server/authConfig.ts                                                        |  22 +++-
 server/db.ts                                                                |  37 +++++-
 16 files changed, 1186 insertions(+), 31 deletions(-)
 create mode 100644 attached_assets/Pasted--List-of-relations-List-of-relations-Schema--1765334883_1765334883493.txt
 create mode 100644 attached_assets/Pasted-oot-srv1170282-var-www-apo360-net-cd-var-www-apo360-net_1765333353849.txt
 create mode 100644 attached_assets/Pasted-redencial-taxi-emision-column-will-be-created-credencia_1765333968142.txt
 create mode 100644 attached_assets/Pasted-root-srv1170282-var-www-apo360-net-cd-var-www-apo360-ne_1765322935733.txt
 create mode 100644 attached_assets/Pasted-root-srv1170282-var-www-apo360-net-pm2-restart-apo360-u_1765333125358.txt
 create mode 100644 attached_assets/Pasted-root-srv1170282-var-www-apo360-net-pm2-start-ecosystem-_1765327761966.txt
 create mode 100644 attached_assets/Pasted-root-srv1170282-var-www-apo360-net-root-srv1170282-var-_1765323644578.txt
 create mode 100644 attached_assets/Pasted-root-srv1170282-var-www-apo360-net-root-srv1170282-var-_1765327946394.txt
 create mode 100644 attached_assets/Pasted-root-srv1170282-var-www-apo360-net-root-srv1170282-var-_1765329509881.txt
 create mode 100644 attached_assets/Pasted-root-srv1170282-var-www-apo360-net-root-srv1170282-var-_1765329796410.txt
 create mode 100644 attached_assets/Pasted-root-srv1170282-var-www-apo360-net-root-srv1170282-var-_1765333564543.txt
 create mode 100644 attached_assets/Pasted-root-srv1170282-var-www-apo360-net-root-srv1170282-var-_1765334745407.txt
root@srv1170282:/var/www/apo360.net# npm install

added 5 packages, removed 26 packages, changed 8 packages, and audited 523 packages in 3s

69 packages are looking for funding
  run `npm fund` for details

9 vulnerabilities (3 low, 5 moderate, 1 high)

To address issues that do not require attention, run:
  npm audit fix

To address all issues (including breaking changes), run:
  npm audit fix --force

Run `npm audit` for details.
root@srv1170282:/var/www/apo360.net# pm2 restart apo360 --update-env
15[PM2] Applying action restartProcessId on app [apo360](ids: [ 0 ])
[PM2] [apo360](0) âœ“
â”Œâ”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ id â”‚ name               â”‚ mode     â”‚ â†º    â”‚ status    â”‚ cpu      â”‚ memory   â”‚
â”œâ”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 0  â”‚ apo360             â”‚ cluster  â”‚ 15   â”‚ online    â”‚ 0%       â”‚ 40.9mb   â”‚
â””â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
root@srv1170282:/var/www/apo360.net# pm2 logs apo360 --lines 15
[TAILING] Tailing last 15 lines for [apo360] process (change the value with --lines option)
/var/www/apo360.net/logs/output-0.log last 15 lines:
0|apo360   | 2025-12-10T03:13:36: 3:13:36 AM [express] GET /api/configuracion/franja_emergencia 500 in 94ms :: {"message":"Error al obâ€¦
0|apo360   | 2025-12-10T03:13:36: 3:13:36 AM [express] GET /api/estadisticas/publicas 500 in 121ms :: {"message":"Error al obtener estâ€¦
0|apo360   | 2025-12-10T03:13:36: 3:13:36 AM [express] GET /api/servicios 500 in 139ms :: {"message":"Error al obtener servicios"}
0|apo360   | 2025-12-10T03:13:41: 3:13:41 AM [express] GET /api/configuracion/franja_emergencia 500 in 13ms :: {"message":"Error al obâ€¦
0|apo360   | 2025-12-10T03:13:41: 3:13:41 AM [express] GET /api/configuracion/roles 500 in 18ms :: {"message":"Error al obtener configâ€¦
0|apo360   | 2025-12-10T03:13:43: 3:13:43 AM [express] POST /api/auth/login 500 in 12ms :: {"message":"Hostname/IP does not match certâ€¦
0|apo360   | 2025-12-10T03:13:46: 3:13:46 AM [express] POST /api/auth/login 500 in 10ms :: {"message":"Hostname/IP does not match certâ€¦
0|apo360   | 2025-12-10T03:13:47: 3:13:47 AM [express] GET /api/login 302 in 3ms
0|apo360   | 2025-12-10T03:13:48: 3:13:48 AM [express] GET /api/callback 500 in 454ms :: {"message":"Hostname/IP does not match certifâ€¦
0|apo360   | 2025-12-10T03:16:27: ğŸ” Modo de autenticaciÃ³n solicitado: google
0|apo360   | 2025-12-10T03:16:27: âœ… Google OAuth configurado correctamente
0|apo360   | 2025-12-10T03:16:27: ğŸš€ Servidor WebSocket configurado en /ws
0|apo360   | 2025-12-10T03:16:27: 3:16:27 AM [express] ğŸ”„ Verificando migraciÃ³n de miembros_grupo...
0|apo360   | 2025-12-10T03:16:27: 3:16:27 AM [express] âš ï¸ Error en migraciÃ³n automÃ¡tica (se ignorarÃ¡): [object Object]
0|apo360   | 2025-12-10T03:16:27: 3:16:27 AM [express] serving on port 5000

/var/www/apo360.net/logs/error-0.log last 15 lines:
0|apo360   |     at process.processTicksAndRejections (node:internal/process/task_queues:95:5)
0|apo360   |     at async NeonPreparedQuery.execute (file:///var/www/apo360.net/node_modules/drizzle-orm/neon-serverless/session.js:76:20)
0|apo360   |     at async DatabaseStorage.upsertUsuario (file:///var/www/apo360.net/dist/index.js:1224:53)
0|apo360   |     at async upsertUser (file:///var/www/apo360.net/dist/index.js:3191:3)
0|apo360   |     at async Strategy._verify (file:///var/www/apo360.net/dist/index.js:3304:9)
0|apo360   | You have triggered an unhandledRejection, you may have forgotten to catch a Promise rejection:
0|apo360   | Error [ERR_MODULE_NOT_FOUND]: Cannot find package 'dotenv' imported from /var/www/apo360.net/dist/index.js
0|apo360   |     at packageResolve (node:internal/modules/esm/resolve:873:9)
0|apo360   |     at moduleResolve (node:internal/modules/esm/resolve:946:18)
0|apo360   |     at defaultResolve (node:internal/modules/esm/resolve:1188:11)
0|apo360   |     at ModuleLoader.defaultResolve (node:internal/modules/esm/loader:708:12)
0|apo360   |     at #cachedDefaultResolve (node:internal/modules/esm/loader:657:25)
0|apo360   |     at ModuleLoader.resolve (node:internal/modules/esm/loader:640:38)
0|apo360   |     at ModuleLoader.getModuleJobForImport (node:internal/modules/esm/loader:264:38)
0|apo360   |     at ModuleJob._link (node:internal/modules/esm/module_job:168:49)

